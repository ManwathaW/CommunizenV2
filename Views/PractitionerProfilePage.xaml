<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:converters="clr-namespace:CommuniZEN.Converters"
             x:Class="CommuniZEN.Views.PractitionerProfilePage"
             Title="{Binding Practitioner.Name}"
             BackgroundColor="#F5F9FF">

    <ContentPage.Resources>
        <ResourceDictionary>
            <converters:Base64ToImageSourceConverter x:Key="Base64ToImageSourceConverter"/>
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid>
        <!-- Loading Indicator -->
        <ActivityIndicator IsVisible="{Binding IsLoading}"
                          IsRunning="{Binding IsLoading}"
                          HorizontalOptions="Center"
                          VerticalOptions="Center"
                          Color="#4B89DC"/>

        <!-- Main Content -->
        <ScrollView>
            <VerticalStackLayout Padding="20" Spacing="20">
                <!-- Profile Header -->
                <Frame Padding="20"
                       BackgroundColor="White"
                       BorderColor="#E8F0FE"
                       HasShadow="True"
                       CornerRadius="15">
                    <VerticalStackLayout Spacing="15">
                        <!-- Profile Image -->
                        <Frame HeightRequest="120"
                               WidthRequest="120"
                               CornerRadius="60"
                               IsClippedToBounds="True"
                               Padding="0"
                               BorderColor="#E8F0FE"
                               HorizontalOptions="Center">
                            <Image Source="{Binding Practitioner.ProfileImage, Converter={StaticResource Base64ToImageSourceConverter}}"
                                   Aspect="AspectFill"/>
                        </Frame>

                        <Label Text="{Binding Practitioner.Name}"
                               FontSize="24"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"/>

                        <Label Text="{Binding Practitioner.Specialization}"
                               FontSize="18"
                               TextColor="#666666"
                               HorizontalOptions="Center"/>

                        <Label Text="{Binding Practitioner.Bio}"
                               TextColor="#666666"
                               HorizontalTextAlignment="Center"/>

                        <Label Text="{Binding Practitioner.Location}"
                               TextColor="#666666"
                               HorizontalTextAlignment="Center"/>
                    </VerticalStackLayout>
                </Frame>

                <!-- Availability Section -->
                <Frame BackgroundColor="White"
                       BorderColor="#E8F0FE"
                       HasShadow="True"
                       Padding="20"
                       CornerRadius="15">
                    <VerticalStackLayout Spacing="15">
                        <Label Text="Available Days"
                               FontSize="18"
                               FontAttributes="Bold"/>

                        <CollectionView ItemsSource="{Binding AvailableDays}">
                            <CollectionView.EmptyView>
                                <Label Text="No available days set"
                                       TextColor="#666666"/>
                            </CollectionView.EmptyView>
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Label Text="{Binding}"
                                           Margin="0,5"
                                           TextColor="#666666"/>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </VerticalStackLayout>
                </Frame>

                <!-- Time Slots -->
                <Frame BackgroundColor="White"
                       BorderColor="#E8F0FE"
                       HasShadow="True"
                       Padding="20"
                       CornerRadius="15">
                    <VerticalStackLayout Spacing="15">
                        <Label Text="Available Time Slots"
                               FontSize="18"
                               FontAttributes="Bold"/>

                        <CollectionView ItemsSource="{Binding TimeSlots}">
                            <CollectionView.EmptyView>
                                <Label Text="No time slots available"
                                       TextColor="#666666"/>
                            </CollectionView.EmptyView>
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Label Text="{Binding Time}"
                                           Margin="0,5"
                                           TextColor="#666666"/>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </VerticalStackLayout>
                </Frame>

                <!-- Book Appointment Button -->
                <Button Text="Book Appointment"
                        Command="{Binding BookAppointmentCommand}"
                        BackgroundColor="#4B89DC"
                        TextColor="White"
                        HeightRequest="50"
                        CornerRadius="25"
                        Margin="0,10,0,20"/>
            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>